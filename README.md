# üßµ –§–æ—Ä—É–º-–ø—Ä–æ—î–∫—Ç –Ω–∞ Node.js —Ç–∞ MySQL

–¶–µ–π –ø—Ä–æ—î–∫—Ç —Ä–µ–∞–ª—ñ–∑—É—î –±–∞–∑–æ–≤–∏–π —Ñ–æ—Ä—É–º —ñ–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º Node.js –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ—ó —á–∞—Å—Ç–∏–Ω–∏ —Ç–∞ MySQL –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö. –ù–∏–∂—á–µ –æ–ø–∏—Å–∞–Ω–æ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó —â–æ–¥–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è, –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö —ñ –∑–∞–ø—É—Å–∫—É –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É **–Ω–∞ Ubuntu**.

---

## üì¶ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è MySQL

```bash
sudo apt update
sudo apt install mysql-server
```

### üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É –¥–æ MySQL

–í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏–π —Ñ–∞–π–ª:

```bash
sudo nano /etc/mysql/mysql.conf.d/mysqld.cnf
```

üîÅ –ó–Ω–∞–π–¥—ñ—Ç—å —Ä—è–¥–æ–∫ `bind-address` —ñ –∑–º—ñ–Ω—ñ—Ç—å –π–æ–≥–æ –Ω–∞:

```
bind-address = 0.0.0.0
```

–¶–µ –¥–æ–∑–≤–æ–ª–∏—Ç—å –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ MySQL –∑ —ñ–Ω—à–∏—Ö —Ö–æ—Å—Ç—ñ–≤.

–ü—ñ—Å–ª—è —Ü—å–æ–≥–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å MySQL:

```bash
sudo service mysql restart
```

---

## üë§ –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

–ó–∞–ø—É—Å—Ç—ñ—Ç—å MySQL:

```bash
mysql -u root -p
```

–í–∏–∫–æ–Ω–∞–π—Ç–µ —Ç–∞–∫—ñ –∫–æ–º–∞–Ω–¥–∏ —É MySQL-–∫–æ–Ω—Å–æ–ª—ñ:

```sql
CREATE USER 'user'@'%' IDENTIFIED BY 'pass';
```

> üîê –ó–∞–º—ñ—Å—Ç—å `%` –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∫–∞–∑–∞—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É IP-–∞–¥—Ä–µ—Å—É —Ö–æ—Å—Ç–∞, —è–∫–æ–º—É –¥–æ–∑–≤–æ–ª–µ–Ω–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è. `%` ‚Äî —Ü–µ —à–∞–±–ª–æ–Ω, —â–æ –¥–æ–∑–≤–æ–ª—è—î –¥–æ—Å—Ç—É–ø –∑ **–±—É–¥—å-—è–∫–æ–≥–æ —Ö–æ—Å—Ç–∞** (–Ω–µ–±–µ–∑–ø–µ—á–Ω–æ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É).
>
> üîë –ü–∞—Ä–æ–ª—å `'pass'` —Å–ª—ñ–¥ –∑–∞–º—ñ–Ω–∏—Ç–∏ –Ω–∞ –Ω–∞–¥—ñ–π–Ω–∏–π, –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º –ø–æ–ª—ñ—Ç–∏–∫ –±–µ–∑–ø–µ–∫–∏.

```sql
GRANT ALL PRIVILEGES ON *.* TO 'user'@'%' WITH GRANT OPTION;
FLUSH PRIVILEGES;
CREATE DATABASE db;
USE db;
```

---

## üóÇ –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—å

```sql
-- –¢–∞–±–ª–∏—Ü—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
CREATE TABLE account (
    id SERIAL PRIMARY KEY,
    login VARCHAR(255) UNIQUE NOT NULL,
    pass VARCHAR(255) NOT NULL,
    name VARCHAR(255) NOT NULL
);

-- –¢–∞–±–ª–∏—Ü—è —Ç–µ–º
CREATE TABLE topics (
    id SERIAL PRIMARY KEY,
    user_id BIGINT UNSIGNED NOT NULL,
    title VARCHAR(255) UNIQUE NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES account(id) ON DELETE CASCADE
);

-- –¢–∞–±–ª–∏—Ü—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
CREATE TABLE messages (
    id SERIAL PRIMARY KEY,
    user_id BIGINT UNSIGNED NOT NULL,
    topic_id BIGINT UNSIGNED NOT NULL,
    message_text TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES account(id) ON DELETE CASCADE,
    FOREIGN KEY (topic_id) REFERENCES topics(id) ON DELETE CASCADE
);
```

---

## ‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Node.js –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É

### –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è NVM —ñ Node.js:

```bash
sudo apt update
curl -fsSL https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.4/install.sh | bash
source ~/.bashrc
nvm install node
nvm use node
```

### –ü–µ—Ä–µ—Ö—ñ–¥ –¥–æ –ø–∞–ø–∫–∏ –∑ –∫–æ–¥–æ–º:

```bash
cd /—à–ª—è—Ö/–¥–æ/—Ç–≤–æ–≥–æ/—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é
```

### –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π:

```bash
sudo apt install npm
sudo npm install
```

---

## üö® –í–ê–ñ–õ–ò–í–ê –ü–†–ò–ú–Ü–¢–ö–ê

üîß **–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—ñ–¥–∫—Ä–∏—Ç–∏ —Ñ–∞–π–ª `db.js` —ñ –∑–º—ñ–Ω–∏—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö:**

```js
const connection = mysql.createConnection({
  host: 'localhost',     // –∞–±–æ IP –≤–∞—à–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ MySQL
  user: 'user',           // —ñ–º‚Äô—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–æ–≥–æ –≤–∏ —Å—Ç–≤–æ—Ä–∏–ª–∏
  password: 'pass',       // –ø–∞—Ä–æ–ª—å
  database: 'db'          // –Ω–∞–∑–≤–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
});
```

–ë–µ–∑ —Ü—å–æ–≥–æ –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫ –Ω–µ –∑–º–æ–∂–µ –∑'—î–¥–Ω–∞—Ç–∏—Å—è –∑ –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö.

---

## üöÄ –ó–∞–ø—É—Å–∫ –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É

```bash
node app.js
```

### (–û–ø—Ü—ñ–π–Ω–æ) –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `pm2` –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω-–∑–∞–ø—É—Å–∫—É:

```bash
npm install -g pm2
pm2 start app.js
```

–î–ª—è –∑—É–ø–∏–Ω–∫–∏:

```bash
pm2 stop app.js
```

---

## üìå –ü—Ä–∏–º—ñ—Ç–∫–∞

- –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Å—è, —â–æ –ø–æ—Ä—Ç, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫, –≤—ñ–¥–∫—Ä–∏—Ç–∏–π —É –±—Ä–∞–Ω–¥–º–∞—É–µ—Ä—ñ –∞–±–æ –≤ cloud-—Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ.
- –ù–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Å—Ä–ø–∞–≤–∂–Ω—ñ –ø–∞—Ä–æ–ª—ñ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –∞–∫–∞—É–Ω—Ç—É, –ø—Ä–æ–µ–∫—Ç –≤–∑–∞–≥–∞–ª—ñ –Ω–µ –∑–∞—Ö–∏—â–µ–Ω–∏–π, —ñ –±—É–≤ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –≤–∏–∫–ª—é—á–Ω–æ –≤ –Ω–∞–≤—á–∞–ª—å–Ω–∏—Ö —Ü—ñ–ª—è—Ö.
